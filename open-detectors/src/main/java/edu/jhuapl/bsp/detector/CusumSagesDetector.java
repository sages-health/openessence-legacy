/*
 * Copyright (c) 2013 The Johns Hopkins University/Applied Physics Laboratory
 *                             All rights reserved.
 *
 * This material may be used, modified, or reproduced by or for the U.S.
 * Government pursuant to the rights granted under the clauses at
 * DFARS 252.227-7013/7014 or FAR 52.227-14.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * NO WARRANTY.   THIS MATERIAL IS PROVIDED "AS IS."  JHU/APL DISCLAIMS ALL
 * WARRANTIES IN THE MATERIAL, WHETHER EXPRESS OR IMPLIED, INCLUDING (BUT NOT
 * LIMITED TO) ANY AND ALL IMPLIED WARRANTIES OF PERFORMANCE,
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT OF
 * INTELLECTUAL PROPERTY RIGHTS. ANY USER OF THE MATERIAL ASSUMES THE ENTIRE
 * RISK AND LIABILITY FOR USING THE MATERIAL.  IN NO EVENT SHALL JHU/APL BE
 * LIABLE TO ANY USER OF THE MATERIAL FOR ANY ACTUAL, INDIRECT,
 * CONSEQUENTIAL, SPECIAL OR OTHER DAMAGES ARISING FROM THE USE OF, OR
 * INABILITY TO USE, THE MATERIAL, INCLUDING, BUT NOT LIMITED TO, ANY DAMAGES
 * FOR LOST PROFITS.
 */

package edu.jhuapl.bsp.detector;

import edu.jhuapl.bsp.detector.exception.DetectorException;

import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Properties;

import static edu.jhuapl.bsp.detector.OpenMath.arrayAdd;
import static edu.jhuapl.bsp.detector.OpenMath.dataInd;
import static edu.jhuapl.bsp.detector.OpenMath.interp1;
import static edu.jhuapl.bsp.detector.OpenMath.max;
import static edu.jhuapl.bsp.detector.OpenMath.mean;
import static edu.jhuapl.bsp.detector.OpenMath.min;
import static edu.jhuapl.bsp.detector.OpenMath.std;

/**
 * Runs the main CUSUM algorithm
 */
public class CusumSagesDetector implements TemporalDetectorInterface, TemporalDetector {

    static final double[][] lookup_table = {
            {0, 1.00E-05, 0.229568613, 0.62171871, 1.119208207, 1.119719396, 1.12020585, 1.120728881, 1.121436238,
             1.122056057, 1.122989996, 1.12327506, 1.12373682, 1.124260034, 1.125046633, 1.125441492, 1.125830458,
             1.126352106, 1.126935883, 1.127623345, 1.128143571, 1.128785117, 1.130183914, 1.13060112, 1.131259638,
             1.131848303, 1.132314587, 1.132731054, 1.133296658, 1.133784787, 1.134453253, 1.134916799, 1.135600752,
             1.136063926, 1.136717091, 1.137435886, 1.138345181, 1.138770846, 1.139264948, 1.139998567, 1.14049575,
             1.141127242, 1.141687379, 1.14244163, 1.143084903, 1.143540465, 1.144166799, 1.14463183, 1.144992758,
             1.145650867, 1.146482982, 1.146971656, 1.14775967, 1.148175201, 1.148676293, 1.149125921, 1.149983728,
             1.150668177, 1.151499004, 1.151786176, 1.152340236, 1.152760503, 1.153051171, 1.153920553, 1.154338289,
             1.155244963, 1.156207252, 1.156528611, 1.157198889, 1.157606392, 1.158276233, 1.158694382, 1.159026303,
             1.159633199, 1.160273182, 1.161046195, 1.161757803, 1.16250617, 1.163501157, 1.163925236, 1.164495382,
             1.165113133, 1.165714734, 1.166182699, 1.166640413, 1.166970105, 1.168026928, 1.168676507, 1.16982235,
             1.170480828, 1.171283226, 1.172372387, 1.173082344, 1.173515618, 1.173838016, 1.17437632, 1.175110566,
             1.175636416, 1.176288981, 1.177188343, 1.178198374, 1.178643817, 1.179520515, 1.180273289, 1.181051373,
             1.181337441, 1.181644827, 1.182299899, 1.18306647, 1.183416161, 1.18389541, 1.184404555, 1.185015762,
             1.185712367, 1.186090438, 1.186849718, 1.187240653, 1.187712622, 1.188229015, 1.188800519, 1.189581601,
             1.190871259, 1.191388205, 1.191970305, 1.192671683, 1.193311413, 1.193651037, 1.194584701, 1.19492889,
             1.195248236, 1.19608701, 1.196629701, 1.197493685, 1.198553709, 1.199251924, 1.20000634, 1.201058668,
             1.201637247, 1.202212737, 1.202718788, 1.203348039, 1.20393577, 1.204504752, 1.205238183, 1.205719046,
             1.206920911, 1.20762591, 1.208318732, 1.208888732, 1.209477947, 1.210036469, 1.210941279, 1.211368771,
             1.211769084, 1.212221276, 1.212570389, 1.21328142, 1.213713656, 1.214486145, 1.214871703, 1.215765635,
             1.216330069, 1.216984897, 1.217577933, 1.2178247, 1.218438743, 1.219082192, 1.219792383, 1.220452104,
             1.220900606, 1.22132852, 1.221854697, 1.222417715, 1.222795111, 1.223204385, 1.223782403, 1.224566751,
             1.225312194, 1.226456077, 1.227000826, 1.227580852, 1.228264669, 1.229010973, 1.229681235, 1.230370207,
             1.23088686, 1.231502384, 1.232666837, 1.232949475, 1.233633427, 1.234837237, 1.235166004, 1.235725011,
             1.236049819, 1.236612632, 1.237493459, 1.237974271, 1.238357427, 1.239113071, 1.240129514, 1.240850164,
             1.241267169, 1.241826197, 1.242120443, 1.242740006, 1.243481946, 1.244176103, 1.245058697, 1.245762098,
             1.246230542, 1.246837677, 1.247735012, 1.248357073, 1.249051346, 1.250259462, 1.251148647, 1.251966391,
             1.252355518, 1.252937289, 1.253517748, 1.25403629, 1.254530624, 1.255320281, 1.255928308, 1.256750782,
             1.257394916, 1.258087902, 1.259002301, 1.259237189, 1.259801735, 1.260431445, 1.260734703, 1.261427344,
             1.262142839, 1.262690301, 1.263450638, 1.263904279, 1.264529038, 1.265545737, 1.26610621, 1.266893211,
             1.267693363, 1.268387355, 1.268991711, 1.269642562, 1.27043506, 1.270859748, 1.271427874, 1.272185707,
             1.272836884, 1.273297712, 1.27401286, 1.274668496, 1.275170519, 1.276107824, 1.27643929, 1.277071489,
             1.277737642, 1.278749053, 1.279690133, 1.280114503, 1.280477854, 1.280899626, 1.281529102, 1.282109734,
             1.282676828, 1.283302222, 1.284279055, 1.28456093, 1.285545459, 1.286002679, 1.286364155, 1.287047672,
             1.287724054, 1.28851208, 1.289704722, 1.290162457, 1.291320022, 1.292213973, 1.293049369, 1.293648236,
             1.294255506, 1.294640065, 1.295227007, 1.295944701, 1.296600887, 1.297341919, 1.297688686, 1.298451759,
             1.299041467, 1.299564389, 1.300330473, 1.300698363, 1.301412992, 1.301824968, 1.30267274, 1.30325616,
             1.303936016, 1.304814552, 1.305554451, 1.306076341, 1.306651706, 1.307503549, 1.308122462, 1.308885919,
             1.309746592, 1.310206286, 1.31091096, 1.31175236, 1.312249154, 1.312782481, 1.313629125, 1.313974903,
             1.314524732, 1.315051134, 1.315763676, 1.316422949, 1.316926973, 1.31759995, 1.318323655, 1.319122738,
             1.319657319, 1.320196063, 1.321169172, 1.321761036, 1.322553197, 1.3229678, 1.323684818, 1.324416886,
             1.3254597, 1.326052403, 1.326908326, 1.327629344, 1.328312865, 1.32872484, 1.329216683, 1.329706037,
             1.330381546, 1.330750396, 1.331724125, 1.332132121, 1.332881777, 1.333643544, 1.334346193, 1.334838517,
             1.335486528, 1.336104833, 1.336743835, 1.337244048, 1.33813806, 1.338878258, 1.339494014, 1.340349845,
             1.341040439, 1.341690259, 1.342501521, 1.343543959, 1.344571898, 1.345146316, 1.345798025, 1.346317834,
             1.346873179, 1.347316369, 1.348001684, 1.34883747, 1.349494624, 1.349892216, 1.351029452, 1.351858982,
             1.352348054, 1.352864433, 1.353338587, 1.353849433, 1.354518332, 1.355097795, 1.355911646, 1.356503535,
             1.357423801, 1.358622392, 1.359273364, 1.359864387, 1.360450125, 1.361323952, 1.362209065, 1.362837461,
             1.363521023, 1.364006435, 1.364443852, 1.365311886, 1.365827307, 1.366465352, 1.367036289, 1.368306056,
             1.36961606, 1.370284537, 1.371189839, 1.371611643, 1.372502534, 1.372905652, 1.373574971, 1.374594682,
             1.375186474, 1.37554796, 1.376323145, 1.377137088, 1.377848447, 1.378298358, 1.378948049, 1.380083939,
             1.380803459, 1.381145715, 1.381625769, 1.382585174, 1.383548231, 1.384153235, 1.385145817, 1.385932013,
             1.386583676, 1.387260057, 1.388056261, 1.388527523, 1.389065288, 1.389513199, 1.390130888, 1.390804052,
             1.391273452, 1.391598278, 1.392159809, 1.392826654, 1.393471523, 1.393895402, 1.394930265, 1.395778817,
             1.396338607, 1.396682823, 1.397621099, 1.398584097, 1.399055929, 1.400649304, 1.401253172, 1.401896088,
             1.402861538, 1.404028362, 1.404770225, 1.405708664, 1.406977254, 1.407832083, 1.409026255, 1.410050603,
             1.410583695, 1.411407808, 1.411803351, 1.412206353, 1.412709754, 1.41322394, 1.413637657, 1.414068894,
             1.414796005, 1.415588743, 1.416280333, 1.417259849, 1.418369511, 1.418930289, 1.420138734, 1.420662037,
             1.421853769, 1.422372685, 1.422971442, 1.42356492, 1.424322015, 1.425433989, 1.426127006, 1.426437577,
             1.427170202, 1.427618812, 1.428472369, 1.429020835, 1.429363185, 1.429874902, 1.430520198, 1.431185148,
             1.432087572, 1.433075074, 1.433551251, 1.434988128, 1.435804591, 1.436491673, 1.43715482, 1.437803527,
             1.438871608, 1.439496735, 1.440428754, 1.441284382, 1.441964621, 1.442626192, 1.4434436, 1.44403688,
             1.444982681, 1.445655082, 1.446206322, 1.447325981, 1.448085666, 1.448703585, 1.449172386, 1.449827804,
             1.45043211, 1.450868217, 1.452057976, 1.452663816, 1.453377756, 1.453775925, 1.454591494, 1.455941901,
             1.456702702, 1.457536312, 1.458345463, 1.45899518, 1.460171103, 1.461324336, 1.462293345, 1.463064758,
             1.464001887, 1.464816668, 1.465640267, 1.46660122, 1.467130981, 1.468088232, 1.469090981, 1.470079459,
             1.471081881, 1.471798035, 1.472478313, 1.473352823, 1.474084812, 1.474864072, 1.475353717, 1.476582533,
             1.477673289, 1.478376319, 1.47924713, 1.479972775, 1.481307223, 1.481711252, 1.482143963, 1.483015529,
             1.4835794, 1.484295762, 1.485127394, 1.486451668, 1.487095335, 1.487925104, 1.488380415, 1.489203063,
             1.490113158, 1.490605482, 1.491761167, 1.493156673, 1.494097574, 1.494867459, 1.496089818, 1.497127705,
             1.497994364, 1.498614724, 1.499444759, 1.5, 1.500866849, 1.501722211, 1.50286289, 1.50368879, 1.50422452,
             1.504833693, 1.505591946, 1.506247726, 1.50691624, 1.507893876, 1.508712755, 1.509464106, 1.509979878,
             1.511007917, 1.511655127, 1.512552176, 1.513267778, 1.51434337, 1.515166971, 1.516001301, 1.516810766,
             1.517264235, 1.517886885, 1.518803551, 1.519548161, 1.52062847, 1.521259576, 1.522017636, 1.522668821,
             1.52320331, 1.524116728, 1.524876867, 1.525732726, 1.526708288, 1.52761144, 1.528332067, 1.528919251,
             1.529282169, 1.529845506, 1.530574328, 1.531938419, 1.532841921, 1.533239951, 1.534286886, 1.535990575,
             1.536879168, 1.537446435, 1.538100769, 1.538682784, 1.539260925, 1.539979877, 1.541219918, 1.541996757,
             1.542668064, 1.543086307, 1.544008242, 1.544946444, 1.545690132, 1.546571913, 1.547369876, 1.548032877,
             1.549027868, 1.549785192, 1.550949499, 1.551648798, 1.551995885, 1.552544021, 1.552972384, 1.553417652,
             1.553891141, 1.554591412, 1.555311001, 1.556066768, 1.55706937, 1.557679744, 1.558518913, 1.559467546,
             1.560220501, 1.560854469, 1.561226253, 1.562544547, 1.563084652, 1.563861544, 1.564650335, 1.565361884,
             1.566001545, 1.566997067, 1.567965412, 1.568623472, 1.569844227, 1.570224466, 1.571105999, 1.57188483,
             1.572693606, 1.573790571, 1.575038798, 1.575751966, 1.576695696, 1.577520984, 1.578331704, 1.578853888,
             1.579442887, 1.580457501, 1.582071057, 1.583257631, 1.58399018, 1.584450468, 1.584888931, 1.585158094,
             1.585740449, 1.587151976, 1.587981554, 1.588476226, 1.588950391, 1.590619443, 1.591911096, 1.592983985,
             1.593594658, 1.59418213, 1.59470878, 1.595624716, 1.59643555, 1.59759421, 1.598201026, 1.599162108,
             1.600142179, 1.600628621, 1.601283576, 1.602272236, 1.602924528, 1.60402323, 1.605199886, 1.606153376,
             1.606859921, 1.607608062, 1.608911627, 1.609514826, 1.611038307, 1.612024507, 1.61277831, 1.613196396,
             1.613998824, 1.61495796, 1.616034842, 1.61703172, 1.617674845, 1.618042026, 1.618901588, 1.619637901,
             1.620124638, 1.620988763, 1.621761018, 1.622823093, 1.623351587, 1.624039074, 1.624813324, 1.626263807,
             1.627021442, 1.627828669, 1.628729421, 1.629297863, 1.630097848, 1.630868155, 1.631550459, 1.632113181,
             1.633851544, 1.634999988, 1.6359421, 1.637119572, 1.637679145, 1.638504667, 1.639654032, 1.640942829,
             1.64218899, 1.643174238, 1.64362966, 1.64453582, 1.644900879, 1.645490128, 1.646201014, 1.647161342,
             1.648069381, 1.648668561, 1.649325989, 1.650191435, 1.651240501, 1.65234469, 1.653213136, 1.653817892,
             1.654411942, 1.655249554, 1.655749569, 1.656394284, 1.657787186, 1.658338909, 1.659307665, 1.660318372,
             1.661225692, 1.662247787, 1.663225111, 1.664088492, 1.664652932, 1.665740176, 1.666697004, 1.667555341,
             1.668400966, 1.669399402, 1.670993042, 1.671739671, 1.673218152, 1.674347784, 1.674944967, 1.675841582,
             1.676865064, 1.677752006, 1.678731541, 1.679394134, 1.68090967, 1.681757561, 1.682608083, 1.683327519,
             1.683570837, 1.684507208, 1.685545462, 1.686723247, 1.687428905, 1.688743227, 1.689228533, 1.690055295,
             1.691139852, 1.692081557, 1.692605324, 1.693464782, 1.693822215, 1.694616377, 1.69580845, 1.697117133,
             1.697808157, 1.698660351, 1.69944384, 1.700208007, 1.701228144, 1.702042013, 1.702976307, 1.703374449,
             1.703956687, 1.705088038, 1.706466529, 1.706981065, 1.707683225, 1.708815151, 1.709643008, 1.710293528,
             1.711498521, 1.712469761, 1.713120312, 1.714004556, 1.715355822, 1.716338888, 1.717047545, 1.718074521,
             1.719135748, 1.720198972, 1.720904104, 1.721942321, 1.723015156, 1.723834128, 1.724963035, 1.726024459,
             1.726743365, 1.727562068, 1.728423753, 1.729396553, 1.72991889, 1.730839942, 1.731784705, 1.733444383,
             1.734255866, 1.734910559, 1.735739791, 1.736893939, 1.737625656, 1.738901464, 1.739825878, 1.74112897,
             1.741620688, 1.742250774, 1.743392528, 1.744432475, 1.745023108, 1.746018909, 1.747076022, 1.747620591,
             1.74878485, 1.749380836, 1.750247348, 1.752232927, 1.752874376, 1.753529881, 1.754875462, 1.755737777,
             1.756786346, 1.757641126, 1.758449878, 1.759117037, 1.760460882, 1.761142224, 1.762303796, 1.763600159,
             1.764996697, 1.766306882, 1.767153415, 1.767856476, 1.768536615, 1.769986989, 1.771471258, 1.772203074,
             1.772750321, 1.774237706, 1.774681592, 1.775384519, 1.776042828, 1.776985807, 1.778086397, 1.779125421,
             1.77976597, 1.780620995, 1.781460839, 1.782578437, 1.783809497, 1.784385006, 1.785377713, 1.786906195,
             1.787800851, 1.788355325, 1.789339107, 1.789792815, 1.790911914, 1.792074037, 1.793368782, 1.794630807,
             1.795571196, 1.796231186, 1.797951636, 1.799003798, 1.799600506, 1.800878434, 1.801918791, 1.803151981,
             1.803776727, 1.804754804, 1.806284228, 1.806953126, 1.807738333, 1.808507764, 1.809564447, 1.810034302,
             1.810541473, 1.811524888, 1.812261053, 1.812830303, 1.813947361, 1.814688328, 1.815749704, 1.816700208,
             1.81787806, 1.818722334, 1.819578595, 1.820967548, 1.821543392, 1.822162978, 1.822480424, 1.82333111,
             1.82446046, 1.825515559, 1.826907651, 1.828114924, 1.828590231, 1.829191172, 1.830177968, 1.831502323,
             1.832624975, 1.833704306, 1.834625973, 1.836188959, 1.83702868, 1.837818835, 1.839534071, 1.841003613,
             1.8417047, 1.842857406, 1.844259314, 1.844941248, 1.845993465, 1.84678257, 1.848133453, 1.849056589,
             1.849849203, 1.850822813, 1.851487403, 1.852346692, 1.853733066, 1.854444158, 1.855568277, 1.856888121,
             1.857345769, 1.858037109, 1.858742124, 1.859614866, 1.860626289, 1.861692677, 1.86275214, 1.864377819,
             1.864984725, 1.866174281, 1.866971139, 1.867412042, 1.867857619, 1.86863975, 1.869859942, 1.871368991,
             1.871951776, 1.872833539, 1.874391131, 1.875386414, 1.876194287, 1.876894805, 1.877714402, 1.878511717,
             1.879493055, 1.880265029, 1.880830092, 1.881556262, 1.883210722, 1.883895373, 1.884700664,
             1.885805811, 1.887840206, 1.888611306, 1.888964406, 1.889886987, 1.891022116, 1.89223443, 1.893239252,
             1.894099637, 1.894607732, 1.896030716, 1.897373237, 1.898369011, 1.89917303, 1.900136279, 1.900726596,
             1.901713456, 1.903052149, 1.904550244, 1.905330147, 1.90576683, 1.906840598, 1.907401628, 1.908732426,
             1.909921089, 1.911141549, 1.911991972, 1.912616863, 1.913294758, 1.914652023, 1.91602174, 1.917038458,
             1.917778984, 1.9187097, 1.919562375, 1.921343197, 1.922727242, 1.923450979, 1.924473109, 1.925668284,
             1.926399186, 1.927366962, 1.928192632, 1.929311616, 1.930349796, 1.931752984, 1.933097302, 1.934648234,
             1.93566765, 1.936685124, 1.937271734, 1.938329351, 1.93928885, 1.94029777, 1.941502932, 1.942442024,
             1.943300815, 1.944206745, 1.945071807, 1.945633218, 1.946836937, 1.947521014, 1.948926447, 1.949569647,
             1.950469745, 1.951808874, 1.952412766, 1.953199308, 1.95421436, 1.95565269, 1.956558498, 1.957412636,
             1.958506554, 1.959277273, 1.96124496, 1.962444256, 1.963606223, 1.964863253, 1.9658057, 1.967040956,
             1.967970423, 1.969365896, 1.970874696, 1.9722319, 1.973651575, 1.974258344, 1.97520964, 1.976264963,
             1.977090774, 1.977822165, 1.97859714, 1.979980212, 1.981587785, 1.982570272, 1.983769358, 1.984432232,
             1.985201222, 1.986192622, 1.98712371, 1.987640548, 1.989255539, 1.989863819, 1.99050607, 1.991729126,
             1.992864685, 1.993842519, 1.995197042, 1.996176685, 1.997546019, 1.998746907, 1.999408395, 2.00088448,
             2.002572983, 2.003555874, 2.004709667, 2.005345914, 2.00626812, 2.008229628, 2.009762471, 2.011354966,
             2.012678042, 2.013698302, 2.014502868, 2.015272731, 2.016412719, 2.017686186, 2.018887207, 2.019782264,
             2.021094045, 2.022749833, 2.024001325, 2.025718588, 2.026754604, 2.027731256, 2.029975331, 2.031298351,
             2.03280569, 2.033760387, 2.035010261, 2.03622406, 2.037929622, 2.039746681, 2.040457204, 2.041450094,
             2.042642774, 2.04396051, 2.045227858, 2.046121809, 2.047833085, 2.04900108, 2.05019199, 2.051063183,
             2.052157433, 2.053026633, 2.053661045, 2.054274871, 2.055424509, 2.056934122, 2.058609833, 2.059462815,
             2.060653731, 2.061758152, 2.063006347, 2.064358267, 2.06565526, 2.066767488, 2.067428048, 2.068172897,
             2.069807695, 2.071348108, 2.072858548, 2.074318158, 2.076486003, 2.077966758, 2.07927574, 2.08035069,
             2.082002994, 2.082904225, 2.084434582, 2.085424977, 2.086636236, 2.088236329, 2.089486956, 2.090275741,
             2.090988651, 2.092247258, 2.093444372, 2.094524136, 2.095198903, 2.096598418, 2.097600127, 2.09980547,
             2.101656875, 2.102312669, 2.103759823, 2.10522267, 2.106637637, 2.107860416, 2.108871304, 2.109549837,
             2.110655206, 2.112534653, 2.113505254, 2.114268216, 2.115782342, 2.117167242, 2.118061236, 2.118686282,
             2.119689504, 2.120787052, 2.12132804, 2.122696474, 2.123382582, 2.124793395, 2.126339719, 2.12783847,
             2.128768141, 2.129413685, 2.131283014, 2.132533501, 2.13355598, 2.134562794, 2.136195752, 2.137222308,
             2.138505325, 2.139242379, 2.140920834, 2.142535075, 2.144331579, 2.145558527, 2.146835777, 2.148714701,
             2.149935076, 2.151684927, 2.15280224, 2.153771542, 2.154913941, 2.156028977, 2.158265575, 2.159527744,
             2.160709336, 2.161850201, 2.163520641, 2.165484616, 2.167283545, 2.168465136, 2.169414794, 2.170307026,
             2.171384254, 2.173103161, 2.174358881, 2.17549547, 2.177629625, 2.178935429, 2.180338604, 2.181822516,
             2.182381905, 2.183218052, 2.184815867, 2.185690762, 2.187444986, 2.188731897, 2.189733187, 2.19054002,
             2.192283159, 2.194162906, 2.195066415, 2.196051061, 2.197619958, 2.199055163, 2.199917464, 2.201365555,
             2.202309596, 2.203609069, 2.205560229, 2.206877755, 2.208698696, 2.210194043, 2.211931304, 2.212799544,
             2.214709748, 2.215963517, 2.218772052, 2.219383113, 2.220769662, 2.221528585, 2.222658116, 2.224195847,
             2.225604725, 2.226744408, 2.229065537, 2.230210385, 2.231960712, 2.233401878, 2.235146081, 2.236325132,
             2.237385273, 2.238392056, 2.241025018, 2.241842659, 2.242930695, 2.24433869, 2.245755846, 2.247000475,
             2.24839747, 2.249004958, 2.250175891, 2.251481978, 2.252924552, 2.253674106, 2.254944527, 2.256718628,
             2.257690804, 2.258438543, 2.260099855, 2.260816517, 2.262005413, 2.263493282, 2.264682448, 2.266341705,
             2.267544913, 2.26884504, 2.270334993, 2.271472949, 2.272666094, 2.274624554, 2.276421396, 2.277419467,
             2.278319862, 2.278944039, 2.280455007, 2.28214298, 2.283334335, 2.285193309, 2.287061242, 2.288639997,
             2.290198881, 2.291190463, 2.292098297, 2.293084163, 2.294204249, 2.295169477, 2.296804528, 2.298218699,
             2.299786631, 2.300571534, 2.301464951, 2.302812093, 2.304368594, 2.305853758, 2.307669864, 2.309501614,
             2.310917218, 2.311655827, 2.313248506, 2.315801699, 2.317341823, 2.318340899, 2.319032982, 2.320632731,
             2.322241554, 2.323986753, 2.3265959, 2.328021309, 2.329806089, 2.331675136, 2.333425754, 2.334022543,
             2.334974507, 2.33723242, 2.338756805, 2.340149832, 2.340956592, 2.342152226, 2.343503721, 2.345285383,
             2.347236993, 2.348988692, 2.350755266, 2.353418265, 2.354845226, 2.355856836, 2.356495164, 2.357307331,
             2.358976974, 2.360662051, 2.363102424, 2.36406729, 2.365475276, 2.367098223, 2.368883203, 2.370301516,
             2.372175257, 2.373312329, 2.375207312, 2.376767596, 2.378420647, 2.380127397, 2.381592991, 2.382713984,
             2.384727883, 2.385435215, 2.387392949, 2.38892115, 2.39032952, 2.392033606, 2.393031022, 2.394522229,
             2.395597248, 2.396822011, 2.397974852, 2.39938984, 2.401772709, 2.403882091, 2.404717172, 2.407190745,
             2.40897972, 2.410276175, 2.411709542, 2.412727714, 2.414047175, 2.416209773, 2.418244558, 2.420219931,
             2.42265171, 2.424697246, 2.426197327, 2.428633761, 2.430289155, 2.432104812, 2.434306831, 2.436109084,
             2.438785684, 2.440526762, 2.441601153, 2.443259896, 2.444507081, 2.445543525, 2.446291099, 2.44889836,
             2.451411714, 2.452852238, 2.454163741, 2.455816837, 2.457773073, 2.459245468, 2.460944663, 2.46330346,
             2.46551958, 2.467104318, 2.468489731, 2.469586606, 2.471185766, 2.472625035, 2.47372757, 2.475393211,
             2.477482647, 2.479781583, 2.482456962, 2.483673527, 2.48515219, 2.487617029, 2.489066234, 2.490537995,
             2.493290012, 2.494272358, 2.495680796, 2.497542972, 2.499074456, 2.499969942, 2.501150594, 2.502455359,
             2.50493642, 2.506433152, 2.508514136, 2.509775323, 2.511617637, 2.513274689, 2.515097147, 2.517479502,
             2.519653257, 2.521104732, 2.522922513, 2.524321602, 2.526384919, 2.528825173, 2.53199725, 2.532858444,
             2.533890866, 2.535352254, 2.536515619, 2.538466378, 2.540057419, 2.541822838, 2.54401152, 2.545759842,
             2.547442762, 2.548659393, 2.549963477, 2.552203968, 2.554058774, 2.555808219, 2.557160063, 2.559463786,
             2.560513845, 2.561898579, 2.564719617, 2.566766787, 2.569965365, 2.571781692, 2.573390069, 2.574808854,
             2.576093634, 2.577485089, 2.578654275, 2.580982296, 2.583728783, 2.584907076, 2.586635084, 2.588625219,
             2.590061718, 2.591253289, 2.593088454, 2.59575946, 2.597726396, 2.599832122, 2.601829515, 2.60281267,
             2.604205226, 2.606082136, 2.60787541, 2.612759841, 2.614673331, 2.61612104, 2.617241346, 2.618268667,
             2.619989498, 2.622021923, 2.624182686, 2.625834432, 2.628070541, 2.630068788, 2.632657149, 2.634018264,
             2.635588063, 2.63711165, 2.639790913, 2.641308712, 2.644087798, 2.647001585, 2.648359235, 2.651441212,
             2.653061676, 2.654946887, 2.656543269, 2.658278506, 2.660191878, 2.662591462, 2.664491576, 2.666175669,
             2.668986971, 2.671315884, 2.673762373, 2.675299512, 2.677066209, 2.680536885, 2.683240379, 2.685640158,
             2.687742799, 2.68928358, 2.690653554, 2.692431629, 2.694229907, 2.696503522, 2.698857641, 2.701915063,
             2.705484419, 2.706907345, 2.708049445, 2.71034381, 2.71143596, 2.712936356, 2.715234656, 2.716816231,
             2.71993479, 2.723635182, 2.727117617, 2.729771112, 2.731703842, 2.734454751, 2.735775346, 2.737767833,
             2.740472417, 2.74263455, 2.744422158, 2.746069301, 2.747460018, 2.749284613, 2.751407467, 2.753924126,
             2.755593169, 2.760218502, 2.761952972, 2.763161236, 2.764869044, 2.767417838, 2.76889626, 2.770853707,
             2.772442785, 2.773777662, 2.775124536, 2.778327802, 2.781776648, 2.782941599, 2.78460867, 2.787716162,
             2.789152293, 2.79197889, 2.794285969, 2.79630351, 2.799374377, 2.801442675, 2.805019223, 2.806683622,
             2.810632028, 2.813147604, 2.815317231, 2.818574615, 2.820329273, 2.822698497, 2.82425344, 2.827180223,
             2.830557892, 2.833544606, 2.835652503, 2.83877841, 2.840992252, 2.844272298, 2.846130883, 2.847455254,
             2.849590874, 2.850732719, 2.852544681, 2.853527166, 2.855317385, 2.85767618, 2.859342838, 2.862151981,
             2.865793934, 2.868597081, 2.869629072, 2.871594814, 2.873252907, 2.876390135, 2.878901243, 2.880713447,
             2.883946776, 2.88600381, 2.88907149, 2.890521294, 2.893113001, 2.894902516, 2.896892968, 2.900861275,
             2.902681378, 2.905795232, 2.908135863, 2.910566386, 2.914794621, 2.919230788, 2.921865923, 2.924845726,
             2.926578841, 2.928472986, 2.931661798, 2.935349923, 2.937094534, 2.939766333, 2.941788712, 2.946313602,
             2.948733477, 2.951376921, 2.953562656, 2.955965301, 2.958189032, 2.960337757, 2.963858982, 2.966601039,
             2.968339326, 2.969710214, 2.972020208, 2.975741729, 2.978561083, 2.98110205, 2.985121446, 2.987693258,
             2.990257605, 2.994020942, 2.99564949, 2.997887868, 3.001129255, 3.004176887, 3.006199826, 3.008337562,
             3.011825392, 3.013429655, 3.014977883, 3.017086326, 3.022801637, 3.024398708, 3.026772908, 3.029112732,
             3.032845637, 3.035332, 3.038167948, 3.041152548, 3.043188054, 3.044916196, 3.046587901, 3.049037613,
             3.053202369, 3.055216883, 3.059125532, 3.061816756, 3.066204876, 3.068761391, 3.07269977, 3.074785797,
             3.077021502, 3.080838928, 3.084551929, 3.088875723, 3.091890943, 3.094952089, 3.098743759, 3.100690317,
             3.10501695, 3.108723956, 3.110199989, 3.112805762, 3.115339197, 3.116689491, 3.120198475, 3.123400415,
             3.126682035, 3.130646629, 3.135346047, 3.138191806, 3.140925852, 3.143542373, 3.145457666, 3.14915492,
             3.151359, 3.153695937, 3.157871567, 3.164157837, 3.168807122, 3.170970007, 3.173659419, 3.176511724,
             3.180449346, 3.183172043, 3.185611246, 3.18892618, 3.193458158, 3.195141235, 3.197835708, 3.198917687,
             3.202410425, 3.206539999, 3.210472752, 3.213864037, 3.217549016, 3.220690216, 3.225415866, 3.230276389,
             3.233818528, 3.23616722, 3.23959685, 3.241684333, 3.245329297, 3.248502747, 3.252725748, 3.256041403,
             3.259384469, 3.262243732, 3.267772224, 3.270640932, 3.274316731, 3.278553279, 3.283390657, 3.286663214,
             3.294622957, 3.298923663, 3.303582836, 3.306416259, 3.30944015, 3.313984162, 3.318875436, 3.324029077,
             3.326204385, 3.329351647, 3.333013927, 3.337721202, 3.342677022, 3.345725804, 3.350737851, 3.355723248,
             3.359097423, 3.363470989, 3.367591288, 3.370419424, 3.374415929, 3.378728065, 3.381396291, 3.38529112,
             3.387166353, 3.391343727, 3.395359967, 3.398368625, 3.406070876, 3.409718172, 3.413871455, 3.418334865,
             3.4234171, 3.429421255, 3.435046781, 3.437496286, 3.438869036, 3.444280303, 3.449726314, 3.454850883,
             3.458430317, 3.464045139, 3.46887252, 3.47302991, 3.476550857, 3.485327167, 3.488795092, 3.495730689,
             3.501339492, 3.50550666, 3.51001628, 3.514191509, 3.518017577, 3.521652364, 3.527627302, 3.532069215,
             3.538571097, 3.543231922, 3.546833556, 3.550536444, 3.555682642, 3.560004107, 3.562742969, 3.565918263,
             3.567598711, 3.572170071, 3.579408257, 3.585239916, 3.590101188, 3.596244307, 3.601046751, 3.60586707,
             3.61261035, 3.618446926, 3.626525485, 3.630513265, 3.635834394, 3.63867418, 3.643669659, 3.648939024,
             3.654904867, 3.660828471, 3.668170852, 3.674283155, 3.679024191, 3.686641627, 3.692165527, 3.697415911,
             3.710109159, 3.714877332, 3.719239778, 3.7237816, 3.727318672, 3.735046563, 3.744734697, 3.749045472,
             3.75308957, 3.759076097, 3.76866556, 3.776836764, 3.786223603, 3.792387382, 3.797746037, 3.802621244,
             3.807601195, 3.811632804, 3.821719963, 3.830067352, 3.834780518, 3.842752208, 3.85301248, 3.859911559,
             3.868180385, 3.876671124, 3.887805387, 3.893267273, 3.900364952, 3.907252214, 3.915570035, 3.923290145,
             3.93260528, 3.944145745, 3.949895313, 3.953255969, 3.960438483, 3.969120688, 3.977904089, 3.985743284,
             3.994436808, 4.002653546, 4.009146187, 4.016866601, 4.032953202, 4.050059096, 4.058766796, 4.070788558,
             4.07892628, 4.086925343, 4.103874423, 4.115359283, 4.126126268, 4.137359317, 4.150261981, 4.166648698,
             4.17916935, 4.186758821, 4.202217279, 4.212673816, 4.226285302, 4.237173534, 4.25255706, 4.270553056,
             4.282768264, 4.289006309, 4.30231958, 4.312268734, 4.320953745, 4.331484894, 4.344811919, 4.360695268,
             4.369216608, 4.383231189, 4.391782771, 4.409260336, 4.426066149, 4.445343132, 4.463080698, 4.480485193,
             4.496774866, 4.505348607, 4.516893438, 4.528225656, 4.544583723, 4.559192304, 4.57045576, 4.591503482,
             4.608098589, 4.621163821, 4.645991582, 4.677630789, 4.702829293, 4.723271012, 4.733775617, 4.765876102,
             4.788105576, 4.811702181, 4.830423584, 4.849580183, 4.869168945, 4.894846589, 4.918908279, 4.944740543,
             4.979195708, 5.012665669, 5.060646196, 5.096673241, 5.125408354, 5.15654161, 5.198831113, 5.256520578,
             5.293730237, 5.363952471, 5.394928094, 5.46503774, 5.538264324, 5.653934897, 5.768896204, 5.915331401,
             6.027509091, 6.173180799, 6.908018515, 9.011010444},
            {1, 0.5, 0.4, 0.3, 0.2, 0.1999, 0.1998, 0.1997, 0.1996, 0.1995, 0.1994, 0.1993, 0.1992, 0.1991, 0.199,
             0.1989, 0.1988, 0.1987, 0.1986, 0.1985, 0.1984, 0.1983, 0.1982, 0.1981, 0.198, 0.1979, 0.1978, 0.1977,
             0.1976, 0.1975, 0.1974, 0.1973, 0.1972, 0.1971, 0.197, 0.1969, 0.1968, 0.1967, 0.1966, 0.1965, 0.1964,
             0.1963, 0.1962, 0.1961, 0.196, 0.1959, 0.1958, 0.1957, 0.1956, 0.1955, 0.1954, 0.1953, 0.1952, 0.1951,
             0.195, 0.1949, 0.1948, 0.1947, 0.1946, 0.1945, 0.1944, 0.1943, 0.1942, 0.1941, 0.194, 0.1939, 0.1938,
             0.1937, 0.1936, 0.1935, 0.1934, 0.1933, 0.1932, 0.1931, 0.193, 0.1929, 0.1928, 0.1927, 0.1926, 0.1925,
             0.1924, 0.1923, 0.1922, 0.1921, 0.192, 0.1919, 0.1918, 0.1917, 0.1916, 0.1915, 0.1914, 0.1913, 0.1912,
             0.1911, 0.191, 0.1909, 0.1908, 0.1907, 0.1906, 0.1905, 0.1904, 0.1903, 0.1902, 0.1901, 0.19, 0.1899,
             0.1898, 0.1897, 0.1896, 0.1895, 0.1894, 0.1893, 0.1892, 0.1891, 0.189, 0.1889, 0.1888, 0.1887, 0.1886,
             0.1885, 0.1884, 0.1883, 0.1882, 0.1881, 0.188, 0.1879, 0.1878, 0.1877, 0.1876, 0.1875, 0.1874, 0.1873,
             0.1872, 0.1871, 0.187, 0.1869, 0.1868, 0.1867, 0.1866, 0.1865, 0.1864, 0.1863, 0.1862, 0.1861, 0.186,
             0.1859, 0.1858, 0.1857, 0.1856, 0.1855, 0.1854, 0.1853, 0.1852, 0.1851, 0.185, 0.1849, 0.1848, 0.1847,
             0.1846, 0.1845, 0.1844, 0.1843, 0.1842, 0.1841, 0.184, 0.1839, 0.1838, 0.1837, 0.1836, 0.1835, 0.1834,
             0.1833, 0.1832, 0.1831, 0.183, 0.1829, 0.1828, 0.1827, 0.1826, 0.1825, 0.1824, 0.1823, 0.1822, 0.1821,
             0.182, 0.1819, 0.1818, 0.1817, 0.1816, 0.1815, 0.1814, 0.1813, 0.1812, 0.1811, 0.181, 0.1809, 0.1808,
             0.1807, 0.1806, 0.1805, 0.1804, 0.1803, 0.1802, 0.1801, 0.18, 0.1799, 0.1798, 0.1797, 0.1796, 0.1795,
             0.1794, 0.1793, 0.1792, 0.1791, 0.179, 0.1789, 0.1788, 0.1787, 0.1786, 0.1785, 0.1784, 0.1783, 0.1782,
             0.1781, 0.178, 0.1779, 0.1778, 0.1777, 0.1776, 0.1775, 0.1774, 0.1773, 0.1772, 0.1771, 0.177, 0.1769,
             0.1768, 0.1767, 0.1766, 0.1765, 0.1764, 0.1763, 0.1762, 0.1761, 0.176, 0.1759, 0.1758, 0.1757, 0.1756,
             0.1755, 0.1754, 0.1753, 0.1752, 0.1751, 0.175, 0.1749, 0.1748, 0.1747, 0.1746, 0.1745, 0.1744, 0.1743,
             0.1742, 0.1741, 0.174, 0.1739, 0.1738, 0.1737, 0.1736, 0.1735, 0.1734, 0.1733, 0.1732, 0.1731, 0.173,
             0.1729, 0.1728, 0.1727, 0.1726, 0.1725, 0.1724, 0.1723, 0.1722, 0.1721, 0.172, 0.1719, 0.1718, 0.1717,
             0.1716, 0.1715, 0.1714, 0.1713, 0.1712, 0.1711, 0.171, 0.1709, 0.1708, 0.1707, 0.1706, 0.1705, 0.1704,
             0.1703, 0.1702, 0.1701, 0.17, 0.1699, 0.1698, 0.1697, 0.1696, 0.1695, 0.1694, 0.1693, 0.1692, 0.1691,
             0.169, 0.1689, 0.1688, 0.1687, 0.1686, 0.1685, 0.1684, 0.1683, 0.1682, 0.1681, 0.168, 0.1679, 0.1678,
             0.1677, 0.1676, 0.1675, 0.1674, 0.1673, 0.1672, 0.1671, 0.167, 0.1669, 0.1668, 0.1667, 0.1666, 0.1665,
             0.1664, 0.1663, 0.1662, 0.1661, 0.166, 0.1659, 0.1658, 0.1657, 0.1656, 0.1655, 0.1654, 0.1653, 0.1652,
             0.1651, 0.165, 0.1649, 0.1648, 0.1647, 0.1646, 0.1645, 0.1644, 0.1643, 0.1642, 0.1641, 0.164, 0.1639,
             0.1638, 0.1637, 0.1636, 0.1635, 0.1634, 0.1633, 0.1632, 0.1631, 0.163, 0.1629, 0.1628, 0.1627, 0.1626,
             0.1625, 0.1624, 0.1623, 0.1622, 0.1621, 0.162, 0.1619, 0.1618, 0.1617, 0.1616, 0.1615, 0.1614, 0.1613,
             0.1612, 0.1611, 0.161, 0.1609, 0.1608, 0.1607, 0.1606, 0.1605, 0.1604, 0.1603, 0.1602, 0.1601, 0.16,
             0.1599, 0.1598, 0.1597, 0.1596, 0.1595, 0.1594, 0.1593, 0.1592, 0.1591, 0.159, 0.1589, 0.1588, 0.1587,
             0.1586, 0.1585, 0.1584, 0.1583, 0.1582, 0.1581, 0.158, 0.1579, 0.1578, 0.1577, 0.1576, 0.1575, 0.1574,
             0.1573, 0.1572, 0.1571, 0.157, 0.1569, 0.1568, 0.1567, 0.1566, 0.1565, 0.1564, 0.1563, 0.1562, 0.1561,
             0.156, 0.1559, 0.1558, 0.1557, 0.1556, 0.1555, 0.1554, 0.1553, 0.1552, 0.1551, 0.155, 0.1549, 0.1548,
             0.1547, 0.1546, 0.1545, 0.1544, 0.1543, 0.1542, 0.1541, 0.154, 0.1539, 0.1538, 0.1537, 0.1536, 0.1535,
             0.1534, 0.1533, 0.1532, 0.1531, 0.153, 0.1529, 0.1528, 0.1527, 0.1526, 0.1525, 0.1524, 0.1523, 0.1522,
             0.1521, 0.152, 0.1519, 0.1518, 0.1517, 0.1516, 0.1515, 0.1514, 0.1513, 0.1512, 0.1511, 0.151, 0.1509,
             0.1508, 0.1507, 0.1506, 0.1505, 0.1504, 0.1503, 0.1502, 0.1501, 0.15, 0.1499, 0.1498, 0.1497, 0.1496,
             0.1495, 0.1494, 0.1493, 0.1492, 0.1491, 0.149, 0.1489, 0.1488, 0.1487, 0.1486, 0.1485, 0.1484, 0.1483,
             0.1482, 0.1481, 0.148, 0.1479, 0.1478, 0.1477, 0.1476, 0.1475, 0.1474, 0.1473, 0.1472, 0.1471, 0.147,
             0.1469, 0.1468, 0.1467, 0.1466, 0.1465, 0.1464, 0.1463, 0.1462, 0.1461, 0.146, 0.1459, 0.1458, 0.1457,
             0.1456, 0.1455, 0.1454, 0.1453, 0.1452, 0.1451, 0.145, 0.1449, 0.1448, 0.1447, 0.1446, 0.1445, 0.1444,
             0.1443, 0.1442, 0.1441, 0.144, 0.1439, 0.1438, 0.1437, 0.1436, 0.1435, 0.1434, 0.1433, 0.1432, 0.1431,
             0.143, 0.1429, 0.1428, 0.1427, 0.1426, 0.1425, 0.1424, 0.1423, 0.1422, 0.1421, 0.142, 0.1419, 0.1418,
             0.1417, 0.1416, 0.1415, 0.1414, 0.1413, 0.1412, 0.1411, 0.141, 0.1409, 0.1408, 0.1407, 0.1406, 0.1405,
             0.1404, 0.1403, 0.1402, 0.1401, 0.14, 0.1399, 0.1398, 0.1397, 0.1396, 0.1395, 0.1394, 0.1393, 0.1392,
             0.1391, 0.139, 0.1389, 0.1388, 0.1387, 0.1386, 0.1385, 0.1384, 0.1383, 0.1382, 0.1381, 0.138, 0.1379,
             0.1378, 0.1377, 0.1376, 0.1375, 0.1374, 0.1373, 0.1372, 0.1371, 0.137, 0.1369, 0.1368, 0.1367, 0.1366,
             0.1365, 0.1364, 0.1363, 0.1362, 0.1361, 0.136, 0.1359, 0.1358, 0.1357, 0.1356, 0.1355, 0.1354, 0.1353,
             0.1352, 0.1351, 0.135, 0.1349, 0.1348, 0.1347, 0.1346, 0.1345, 0.1344, 0.1343, 0.1342, 0.1341, 0.134,
             0.1339, 0.1338, 0.1337, 0.1336, 0.1335, 0.1334, 0.1333, 0.1332, 0.1331, 0.133, 0.1329, 0.1328, 0.1327,
             0.1326, 0.1325, 0.1324, 0.1323, 0.1322, 0.1321, 0.132, 0.1319, 0.1318, 0.1317, 0.1316, 0.1315, 0.1314,
             0.1313, 0.1312, 0.1311, 0.131, 0.1309, 0.1308, 0.1307, 0.1306, 0.1305, 0.1304, 0.1303, 0.1302, 0.1301,
             0.13, 0.1299, 0.1298, 0.1297, 0.1296, 0.1295, 0.1294, 0.1293, 0.1292, 0.1291, 0.129, 0.1289, 0.1288,
             0.1287, 0.1286, 0.1285, 0.1284, 0.1283, 0.1282, 0.1281, 0.128, 0.1279, 0.1278, 0.1277, 0.1276, 0.1275,
             0.1274, 0.1273, 0.1272, 0.1271, 0.127, 0.1269, 0.1268, 0.1267, 0.1266, 0.1265, 0.1264, 0.1263, 0.1262,
             0.1261, 0.126, 0.1259, 0.1258, 0.1257, 0.1256, 0.1255, 0.1254, 0.1253, 0.1252, 0.1251, 0.125, 0.1249,
             0.1248, 0.1247, 0.1246, 0.1245, 0.1244, 0.1243, 0.1242, 0.1241, 0.124, 0.1239, 0.1238, 0.1237, 0.1236,
             0.1235, 0.1234, 0.1233, 0.1232, 0.1231, 0.123, 0.1229, 0.1228, 0.1227, 0.1226, 0.1225, 0.1224, 0.1223,
             0.1222, 0.1221, 0.122, 0.1219, 0.1218, 0.1217, 0.1216, 0.1215, 0.1214, 0.1213, 0.1212, 0.1211, 0.121,
             0.1209, 0.1208, 0.1207, 0.1206, 0.1205, 0.1204, 0.1203, 0.1202, 0.1201, 0.12, 0.1199, 0.1198, 0.1197,
             0.1196, 0.1195, 0.1194, 0.1193, 0.1192, 0.1191, 0.119, 0.1189, 0.1188, 0.1187, 0.1186, 0.1185, 0.1184,
             0.1183, 0.1182, 0.1181, 0.118, 0.1179, 0.1178, 0.1177, 0.1176, 0.1175, 0.1174, 0.1173, 0.1172, 0.1171,
             0.117, 0.1169, 0.1168, 0.1167, 0.1166, 0.1165, 0.1164, 0.1163, 0.1162, 0.1161, 0.116, 0.1159, 0.1158,
             0.1157, 0.1156, 0.1155, 0.1154, 0.1153, 0.1152, 0.1151, 0.115, 0.1149, 0.1148, 0.1147, 0.1146, 0.1145,
             0.1144, 0.1143, 0.1142, 0.1141, 0.114, 0.1139, 0.1138, 0.1137, 0.1136, 0.1135, 0.1134, 0.1133, 0.1132,
             0.1131, 0.113, 0.1129, 0.1128, 0.1127, 0.1126, 0.1125, 0.1124, 0.1123, 0.1122, 0.1121, 0.112, 0.1119,
             0.1118, 0.1117, 0.1116, 0.1115, 0.1114, 0.1113, 0.1112, 0.1111, 0.111, 0.1109, 0.1108, 0.1107, 0.1106,
             0.1105, 0.1104, 0.1103, 0.1102, 0.1101, 0.11, 0.1099, 0.1098, 0.1097, 0.1096, 0.1095, 0.1094, 0.1093,
             0.1092, 0.1091, 0.109, 0.1089, 0.1088, 0.1087, 0.1086, 0.1085, 0.1084, 0.1083, 0.1082, 0.1081, 0.108,
             0.1079, 0.1078, 0.1077, 0.1076, 0.1075, 0.1074, 0.1073, 0.1072, 0.1071, 0.107, 0.1069, 0.1068, 0.1067,
             0.1066, 0.1065, 0.1064, 0.1063, 0.1062, 0.1061, 0.106, 0.1059, 0.1058, 0.1057, 0.1056, 0.1055, 0.1054,
             0.1053, 0.1052, 0.1051, 0.105, 0.1049, 0.1048, 0.1047, 0.1046, 0.1045, 0.1044, 0.1043, 0.1042, 0.1041,
             0.104, 0.1039, 0.1038, 0.1037, 0.1036, 0.1035, 0.1034, 0.1033, 0.1032, 0.1031, 0.103, 0.1029, 0.1028,
             0.1027, 0.1026, 0.1025, 0.1024, 0.1023, 0.1022, 0.1021, 0.102, 0.1019, 0.1018, 0.1017, 0.1016, 0.1015,
             0.1014, 0.1013, 0.1012, 0.1011, 0.101, 0.1009, 0.1008, 0.1007, 0.1006, 0.1005, 0.1004,
             0.1003, 0.1002, 0.1001, 0.1, 0.0999, 0.0998, 0.0997, 0.0996, 0.0995, 0.0994, 0.0993, 0.0992, 0.0991, 0.099,
             0.0989, 0.0988, 0.0987, 0.0986, 0.0985, 0.0984, 0.0983, 0.0982, 0.0981, 0.098, 0.0979, 0.0978, 0.0977,
             0.0976, 0.0975, 0.0974, 0.0973, 0.0972, 0.0971, 0.097, 0.0969, 0.0968, 0.0967, 0.0966, 0.0965, 0.0964,
             0.0963, 0.0962, 0.0961, 0.096, 0.0959, 0.0958, 0.0957, 0.0956, 0.0955, 0.0954, 0.0953, 0.0952, 0.0951,
             0.095, 0.0949, 0.0948, 0.0947, 0.0946, 0.0945, 0.0944, 0.0943, 0.0942, 0.0941, 0.094, 0.0939, 0.0938,
             0.0937, 0.0936, 0.0935, 0.0934, 0.0933, 0.0932, 0.0931, 0.093, 0.0929, 0.0928, 0.0927, 0.0926, 0.0925,
             0.0924, 0.0923, 0.0922, 0.0921, 0.092, 0.0919, 0.0918, 0.0917, 0.0916, 0.0915, 0.0914, 0.0913, 0.0912,
             0.0911, 0.091, 0.0909, 0.0908, 0.0907, 0.0906, 0.0905, 0.0904, 0.0903, 0.0902, 0.0901, 0.09, 0.0899,
             0.0898, 0.0897, 0.0896, 0.0895, 0.0894, 0.0893, 0.0892, 0.0891, 0.089, 0.0889, 0.0888, 0.0887, 0.0886,
             0.0885, 0.0884, 0.0883, 0.0882, 0.0881, 0.088, 0.0879, 0.0878, 0.0877, 0.0876, 0.0875, 0.0874, 0.0873,
             0.0872, 0.0871, 0.087, 0.0869, 0.0868, 0.0867, 0.0866, 0.0865, 0.0864, 0.0863, 0.0862, 0.0861, 0.086,
             0.0859, 0.0858, 0.0857, 0.0856, 0.0855, 0.0854, 0.0853, 0.0852, 0.0851, 0.085, 0.0849, 0.0848, 0.0847,
             0.0846, 0.0845, 0.0844, 0.0843, 0.0842, 0.0841, 0.084, 0.0839, 0.0838, 0.0837, 0.0836, 0.0835, 0.0834,
             0.0833, 0.0832, 0.0831, 0.083, 0.0829, 0.0828, 0.0827, 0.0826, 0.0825, 0.0824, 0.0823, 0.0822, 0.0821,
             0.082, 0.0819, 0.0818, 0.0817, 0.0816, 0.0815, 0.0814, 0.0813, 0.0812, 0.0811, 0.081, 0.0809, 0.0808,
             0.0807, 0.0806, 0.0805, 0.0804, 0.0803, 0.0802, 0.0801, 0.08, 0.0799, 0.0798, 0.0797, 0.0796, 0.0795,
             0.0794, 0.0793, 0.0792, 0.0791, 0.079, 0.0789, 0.0788, 0.0787, 0.0786, 0.0785, 0.0784, 0.0783, 0.0782,
             0.0781, 0.078, 0.0779, 0.0778, 0.0777, 0.0776, 0.0775, 0.0774, 0.0773, 0.0772, 0.0771, 0.077, 0.0769,
             0.0768, 0.0767, 0.0766, 0.0765, 0.0764, 0.0763, 0.0762, 0.0761, 0.076, 0.0759, 0.0758, 0.0757, 0.0756,
             0.0755, 0.0754, 0.0753, 0.0752, 0.0751, 0.075, 0.0749, 0.0748, 0.0747, 0.0746, 0.0745, 0.0744, 0.0743,
             0.0742, 0.0741, 0.074, 0.0739, 0.0738, 0.0737, 0.0736, 0.0735, 0.0734, 0.0733, 0.0732, 0.0731, 0.073,
             0.0729, 0.0728, 0.0727, 0.0726, 0.0725, 0.0724, 0.0723, 0.0722, 0.0721, 0.072, 0.0719, 0.0718, 0.0717,
             0.0716, 0.0715, 0.0714, 0.0713, 0.0712, 0.0711, 0.071, 0.0709, 0.0708, 0.0707, 0.0706, 0.0705, 0.0704,
             0.0703, 0.0702, 0.0701, 0.07, 0.0699, 0.0698, 0.0697, 0.0696, 0.0695, 0.0694, 0.0693, 0.0692, 0.0691,
             0.069, 0.0689, 0.0688, 0.0687, 0.0686, 0.0685, 0.0684, 0.0683, 0.0682, 0.0681, 0.068, 0.0679, 0.0678,
             0.0677, 0.0676, 0.0675, 0.0674, 0.0673, 0.0672, 0.0671, 0.067, 0.0669, 0.0668, 0.0667, 0.0666, 0.0665,
             0.0664, 0.0663, 0.0662, 0.0661, 0.066, 0.0659, 0.0658, 0.0657, 0.0656, 0.0655, 0.0654, 0.0653, 0.0652,
             0.0651, 0.065, 0.0649, 0.0648, 0.0647, 0.0646, 0.0645, 0.0644, 0.0643, 0.0642, 0.0641, 0.064, 0.0639,
             0.0638, 0.0637, 0.0636, 0.0635, 0.0634, 0.0633, 0.0632, 0.0631, 0.063, 0.0629, 0.0628, 0.0627, 0.0626,
             0.0625, 0.0624, 0.0623, 0.0622, 0.0621, 0.062, 0.0619, 0.0618, 0.0617, 0.0616, 0.0615, 0.0614, 0.0613,
             0.0612, 0.0611, 0.061, 0.0609, 0.0608, 0.0607, 0.0606, 0.0605, 0.0604, 0.0603, 0.0602, 0.0601, 0.06,
             0.0599, 0.0598, 0.0597, 0.0596, 0.0595, 0.0594, 0.0593, 0.0592, 0.0591, 0.059, 0.0589, 0.0588, 0.0587,
             0.0586, 0.0585, 0.0584, 0.0583, 0.0582, 0.0581, 0.058, 0.0579, 0.0578, 0.0577, 0.0576, 0.0575, 0.0574,
             0.0573, 0.0572, 0.0571, 0.057, 0.0569, 0.0568, 0.0567, 0.0566, 0.0565, 0.0564, 0.0563, 0.0562, 0.0561,
             0.056, 0.0559, 0.0558, 0.0557, 0.0556, 0.0555, 0.0554, 0.0553, 0.0552, 0.0551, 0.055, 0.0549, 0.0548,
             0.0547, 0.0546, 0.0545, 0.0544, 0.0543, 0.0542, 0.0541, 0.054, 0.0539, 0.0538, 0.0537, 0.0536, 0.0535,
             0.0534, 0.0533, 0.0532, 0.0531, 0.053, 0.0529, 0.0528, 0.0527, 0.0526, 0.0525, 0.0524, 0.0523, 0.0522,
             0.0521, 0.052, 0.0519, 0.0518, 0.0517, 0.0516, 0.0515, 0.0514, 0.0513, 0.0512, 0.0511, 0.051, 0.0509,
             0.0508, 0.0507, 0.0506, 0.0505, 0.0504, 0.0503, 0.0502, 0.0501, 0.05, 0.0499, 0.0498, 0.0497, 0.0496,
             0.0495, 0.0494, 0.0493, 0.0492, 0.0491, 0.049, 0.0489, 0.0488, 0.0487, 0.0486, 0.0485, 0.0484, 0.0483,
             0.0482, 0.0481, 0.048, 0.0479, 0.0478, 0.0477, 0.0476, 0.0475, 0.0474, 0.0473, 0.0472, 0.0471, 0.047,
             0.0469, 0.0468, 0.0467, 0.0466, 0.0465, 0.0464, 0.0463, 0.0462, 0.0461, 0.046, 0.0459, 0.0458, 0.0457,
             0.0456, 0.0455, 0.0454, 0.0453, 0.0452, 0.0451, 0.045, 0.0449, 0.0448, 0.0447, 0.0446, 0.0445, 0.0444,
             0.0443, 0.0442, 0.0441, 0.044, 0.0439, 0.0438, 0.0437, 0.0436, 0.0435, 0.0434, 0.0433, 0.0432, 0.0431,
             0.043, 0.0429, 0.0428, 0.0427, 0.0426, 0.0425, 0.0424, 0.0423, 0.0422, 0.0421, 0.042, 0.0419, 0.0418,
             0.0417, 0.0416, 0.0415, 0.0414, 0.0413, 0.0412, 0.0411, 0.041, 0.0409, 0.0408, 0.0407, 0.0406, 0.0405,
             0.0404, 0.0403, 0.0402, 0.0401, 0.04, 0.0399, 0.0398, 0.0397, 0.0396, 0.0395, 0.0394, 0.0393, 0.0392,
             0.0391, 0.039, 0.0389, 0.0388, 0.0387, 0.0386, 0.0385, 0.0384, 0.0383, 0.0382, 0.0381, 0.038, 0.0379,
             0.0378, 0.0377, 0.0376, 0.0375, 0.0374, 0.0373, 0.0372, 0.0371, 0.037, 0.0369, 0.0368, 0.0367, 0.0366,
             0.0365, 0.0364, 0.0363, 0.0362, 0.0361, 0.036, 0.0359, 0.0358, 0.0357, 0.0356, 0.0355, 0.0354, 0.0353,
             0.0352, 0.0351, 0.035, 0.0349, 0.0348, 0.0347, 0.0346, 0.0345, 0.0344, 0.0343, 0.0342, 0.0341, 0.034,
             0.0339, 0.0338, 0.0337, 0.0336, 0.0335, 0.0334, 0.0333, 0.0332, 0.0331, 0.033, 0.0329, 0.0328, 0.0327,
             0.0326, 0.0325, 0.0324, 0.0323, 0.0322, 0.0321, 0.032, 0.0319, 0.0318, 0.0317, 0.0316, 0.0315, 0.0314,
             0.0313, 0.0312, 0.0311, 0.031, 0.0309, 0.0308, 0.0307, 0.0306, 0.0305, 0.0304, 0.0303, 0.0302, 0.0301,
             0.03, 0.0299, 0.0298, 0.0297, 0.0296, 0.0295, 0.0294, 0.0293, 0.0292, 0.0291, 0.029, 0.0289, 0.0288,
             0.0287, 0.0286, 0.0285, 0.0284, 0.0283, 0.0282, 0.0281, 0.028, 0.0279, 0.0278, 0.0277, 0.0276, 0.0275,
             0.0274, 0.0273, 0.0272, 0.0271, 0.027, 0.0269, 0.0268, 0.0267, 0.0266, 0.0265, 0.0264, 0.0263, 0.0262,
             0.0261, 0.026, 0.0259, 0.0258, 0.0257, 0.0256, 0.0255, 0.0254, 0.0253, 0.0252, 0.0251, 0.025, 0.0249,
             0.0248, 0.0247, 0.0246, 0.0245, 0.0244, 0.0243, 0.0242, 0.0241, 0.024, 0.0239, 0.0238, 0.0237, 0.0236,
             0.0235, 0.0234, 0.0233, 0.0232, 0.0231, 0.023, 0.0229, 0.0228, 0.0227, 0.0226, 0.0225, 0.0224, 0.0223,
             0.0222, 0.0221, 0.022, 0.0219, 0.0218, 0.0217, 0.0216, 0.0215, 0.0214, 0.0213, 0.0212, 0.0211, 0.021,
             0.0209, 0.0208, 0.0207, 0.0206, 0.0205, 0.0204, 0.0203, 0.0202, 0.0201, 0.02, 0.0199, 0.0198, 0.0197,
             0.0196, 0.0195, 0.0194, 0.0193, 0.0192, 0.0191, 0.019, 0.0189, 0.0188, 0.0187, 0.0186, 0.0185, 0.0184,
             0.0183, 0.0182, 0.0181, 0.018, 0.0179, 0.0178, 0.0177, 0.0176, 0.0175, 0.0174, 0.0173, 0.0172, 0.0171,
             0.017, 0.0169, 0.0168, 0.0167, 0.0166, 0.0165, 0.0164, 0.0163, 0.0162, 0.0161, 0.016, 0.0159, 0.0158,
             0.0157, 0.0156, 0.0155, 0.0154, 0.0153, 0.0152, 0.0151, 0.015, 0.0149, 0.0148, 0.0147, 0.0146, 0.0145,
             0.0144, 0.0143, 0.0142, 0.0141, 0.014, 0.0139, 0.0138, 0.0137, 0.0136, 0.0135, 0.0134, 0.0133, 0.0132,
             0.0131, 0.013, 0.0129, 0.0128, 0.0127, 0.0126, 0.0125, 0.0124, 0.0123, 0.0122, 0.0121, 0.012, 0.0119,
             0.0118, 0.0117, 0.0116, 0.0115, 0.0114, 0.0113, 0.0112, 0.0111, 0.011, 0.0109, 0.0108, 0.0107, 0.0106,
             0.0105, 0.0104, 0.0103, 0.0102, 0.0101, 0.01, 0.0099, 0.0098, 0.0097, 0.0096, 0.0095, 0.0094, 0.0093,
             0.0092, 0.0091, 0.009, 0.0089, 0.0088, 0.0087, 0.0086, 0.0085, 0.0084, 0.0083, 0.0082, 0.0081, 0.008,
             0.0079, 0.0078, 0.0077, 0.0076, 0.0075, 0.0074, 0.0073, 0.0072, 0.0071, 0.007, 0.0069, 0.0068, 0.0067,
             0.0066, 0.0065, 0.0064, 0.0063, 0.0062, 0.0061, 0.006, 0.0059, 0.0058, 0.0057, 0.0056, 0.0055, 0.0054,
             0.0053, 0.0052, 0.0051, 0.005, 0.0049, 0.0048, 0.0047, 0.0046, 0.0045, 0.0044, 0.0043, 0.0042, 0.0041,
             0.004, 0.0039, 0.0038, 0.0037, 0.0036, 0.0035, 0.0034, 0.0033, 0.0032, 0.0031, 0.003, 0.0029, 0.0028,
             0.0027, 0.0026, 0.0025, 0.0024, 0.0023, 0.0022, 0.0021, 0.002, 0.0019, 0.0018, 0.0017, 0.0016, 0.0015,
             0.0014, 0.0013, 0.0012, 0.0011, 0.001, 0.0009, 0.0008, 0.0007, 0.0006, 0.0005, 0.0004, 0.0003, 0.0002,
             1.00E-04, 1.00E-05}
    };
    //
    static final double CUSUM_K = 0.5;
    static final int BASELINE = 28;
    static final int GUARDBAND = 2;
    static final double MIN_SIGMA = 0.5;
    static final double RESET_LEVEL = 4;
    static final double THRESHOLD_PROBABILITY_RED_ALERT = 0.01;
    static final double THRESHOLD_PROBABILITY_YELLOW_ALERT = 0.05;
    //
    private double data[];
    protected double threshPValueR, threshPValueY;
    private double cusum_k, minLT, maxLT;
    private double levels[], pvalues[], expectedData[], colors[], r2Levels[], switchFlags[], test_stat[];

    //
    public CusumSagesDetector() {
        cusum_k = CUSUM_K;
        minLT = min(lookup_table[0]);
        maxLT = max(lookup_table[0]);
        threshPValueR = THRESHOLD_PROBABILITY_RED_ALERT;
        threshPValueY = THRESHOLD_PROBABILITY_YELLOW_ALERT;
        readConfigFile();
    }

    @Override
    public String getID() {
        return "cusum";
    }

    @Override
    public String getName() {
        return "CusumSages";
    }

    @Override
    public double getRedLevel() {
        return threshPValueR;
    }

    @Override
    public void setRedLevel(double _redLevel) {
        threshPValueR = _redLevel;
    }

    @Override
    public double getYellowLevel() {
        return threshPValueY;
    }

    @Override
    public void setYellowLevel(double _yellowLevel) {
        threshPValueY = _yellowLevel;
    }

    //
    private void calculate(double data[]) {
        if (data.length <= BASELINE) {
            String
                    message =
                    getName() + " detector needs at least " + (BASELINE + GUARDBAND) + " data points to run detection.";
            throw new DetectorException(message);
        }
        setData(data);
        calculate();
    }

    private void calculate() {
        FilterBaselineZeros3 zf = new FilterBaselineZeros3();
        ArrayList<Integer> ndxBaseline = new ArrayList<Integer>();
//
        levels = new double[data.length];
        Arrays.fill(levels, 0.5);
        pvalues = new double[data.length];
        Arrays.fill(pvalues, 1);
        expectedData = new double[data.length];
        Arrays.fill(expectedData, 0);
        colors = new double[data.length];
        r2Levels = new double[data.length];
        Arrays.fill(r2Levels, 0);
        switchFlags = new double[data.length];
        Arrays.fill(switchFlags, 0);
        test_stat = new double[data.length];
        Arrays.fill(test_stat, 0);
//
        for (int i = 0; i < BASELINE; i++) {
            ndxBaseline.add(new Integer(i));
        }
//
        double testBase[], sigma, baselineData[], baselineMean, zStat, carryOver, statLookupVals[];
        statLookupVals = new double[data.length];
        Arrays.fill(statLookupVals, 0);
//
        for (int i = BASELINE + GUARDBAND; i < data.length; i++) {
            testBase = dataInd(data, ndxBaseline);
            int[] ndxOK = zf.filterBaselineZeros(testBase);
            baselineData = dataInd(testBase, ndxOK);
            if (baselineData.length > 1) { // min 2 needed - stdev
                sigma = Math.max(std(baselineData), MIN_SIGMA);
                baselineMean = mean(baselineData);
                expectedData[i] = baselineMean;
                zStat = (data[i] - baselineMean) / sigma;
                if (test_stat[i - 1] > RESET_LEVEL) {
                    carryOver = 0.5 * RESET_LEVEL;
                } else {
                    carryOver = Math.max(0, test_stat[i - 1]);
                }
                test_stat[i] = Math.max(0, carryOver + zStat - cusum_k);
                levels[i] = test_stat[i];

            } else {
                if (data[i] > 0) {
                    test_stat[i] = data[i];
                    levels[i] = test_stat[i];
                }
            }
            arrayAdd(ndxBaseline, 1);
        }
        for (int i = BASELINE + GUARDBAND; i < data.length; i++) {
            statLookupVals[i] = Math.max(minLT, Math.min(maxLT, test_stat[i]));
            pvalues[i] = interp1(lookup_table[0], lookup_table[1], statLookupVals[i]);
        }
        for (int i = 0; i < data.length; i++) {
            levels[i] = pvalues[i];
        }
    }

    private void readConfigFile() {
        Properties defaultProps = new Properties();
        InputStream in = getClass().getResourceAsStream("/CusumSagesDetector.properties");
        try {
            defaultProps.load(in);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
        String red = defaultProps.getProperty("THRESHOLD_PROBABILITY_RED_ALERT");
        String yellow = defaultProps.getProperty("THRESHOLD_PROBABILITY_YELLOW_ALERT");
        setRedLevel(Double.parseDouble(red));
        setYellowLevel(Double.parseDouble(yellow));
        try {
            in.close();
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
    }

    public void testDetector(TemporalDetectorDataInterface tddi) {
        double[] data = tddi.getCounts();
        calculate(data);
        tddi.setLevels(getLevels());
    }

    @Override
    public void runDetector(TemporalDetectorDataInterface tddi) {
        double[] data = tddi.getCounts();
//
        calculate(data);
        DetectorHelper.postDetectionColorCoding(data, levels, colors, getRedLevel(), getYellowLevel(), 0.5, false);
//
        tddi.setLevels(getLevels());
        tddi.setExpecteds(getExpecteds());
        tddi.setColors(getColors());
        tddi.setR2Levels(getR2Levels());
        tddi.setSwitchFlags(getSwitchFlags());
        tddi.setTestStatistics(getTestStats());
    }

    @Override
    public double[][] runDetector(double[] data, java.util.Date startDate) {
        TemporalDetectorSimpleDataObject tddo = new TemporalDetectorSimpleDataObject();
        tddo.setCounts(data);
        tddo.setStartDate(startDate);
        this.runDetector(tddo);
        double[][] ans = {tddo.getLevels(), tddo.getExpecteds(), tddo.getColors(),
                          tddo.getSwitchFlags(), tddo.getR2Levels()};
        return ans;
    }

    /**
     * @param ds
     */
    public void setData(double[] ds) {
        data = ds;
    }

    /**
     * @return array of levels
     */
    public double[] getLevels() {
        return levels;
    }

    /**
     * @return array of expecteds
     */
    public double[] getExpecteds() {
        return expectedData;
    }

    /**
     * @return array of colors
     */
    public double[] getColors() {
        return colors;
    }

    /**
     * @return array of R2 levels
     */
    public double[] getR2Levels() {
        return r2Levels;
    }

    /**
     * @return array of switch flags
     */
    public double[] getSwitchFlags() {
        return switchFlags;
    }

    /**
     * @return array of test statistics
     */
    public double[] getTestStats() {
        return test_stat;
    }
}
